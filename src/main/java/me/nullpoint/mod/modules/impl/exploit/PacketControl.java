package me.nullpoint.mod.modules.impl.exploit;

import me.nullpoint.api.events.eventbus.EventHandler;
import me.nullpoint.api.events.impl.PacketEvent;
import me.nullpoint.mod.modules.Beta;
import me.nullpoint.mod.modules.Module;
import me.nullpoint.mod.modules.settings.impl.SliderSetting;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;

@Beta
public class PacketControl extends Module {
    public static PacketControl INSTANCE;
    public PacketControl() {
        super("PacketControl", Category.Exploit);
        INSTANCE = this;
    }

    private final SliderSetting fullPackets =
            add(new SliderSetting("FullPackets", 15, 1, 50));
    private final SliderSetting positionPackets =
            add(new SliderSetting("PositionPackets", 15, 1, 50));
    private int fullPacket;
    private int positionPacket;
    public boolean full;

    @EventHandler
    public final void onPacketSend(final PacketEvent.Send event) {
        if (event.getPacket() instanceof PlayerMoveC2SPacket.PositionAndOnGround && !full) {
            positionPacket++;
            if (positionPacket >= positionPackets.getValue()) {
                positionPacket = 0;
                full = true;
            }
        } else if (event.getPacket() instanceof PlayerMoveC2SPacket.Full && full) {
            fullPacket++;
            if (fullPacket > fullPackets.getValue()) {
                fullPacket = 0;
                full = false;
            }
        }
    }
}
